<!DOCTYPE HTML>
<html lang="en">
  <head>
    <!-- ============================================= -->
    <!-- Metadata                                      -->
    <!-- ============================================= -->
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- ============================================= -->
    <!-- Fonts                                         -->
    <!-- ============================================= -->
    <link rel="stylesheet" href="http://fonts.googleapis.com/icon?family=Material+Icons"/>

    <!-- ============================================= -->
    <!-- Stylesheets                                   -->
    <!-- ============================================= -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css"/>

    <!-- ============================================= -->
    <!-- Document Title                                -->
    <!-- ============================================= -->
    <title>D3 Project</title>
  </head>

  <style>
    .axis path {
      display: none;
    }

    .line {
      fill: none;
      stroke: royalblue;
      stroke-width: 3px;
    }

    .bar {
      fill: royalblue;
    }

    .bar:hover {
      fill: skyblue;
    }

    .tooltip {
      position: absolute;
      text-align: center;
      width: 60px;
      height: 18px;
      padding: 2px;
      font: 12px sans-serif;
      background: lightsteelblue;
      border: 0px;
      border-radius: 8px;
      pointer-events: none;
    }

  </style>

  <body>
    <!-- ============================================= -->
    <!-- External JavaScripts                          -->
    <!-- ============================================= -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>
    <script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
    <script type="text/javascript" src="./test1.js"></script>

    <div class="container">
      <div id="title" class="row center-align">
        <h2>District of Colubmia</h2>
        <h5>Real Estate Market Analysis</h5>
        <h6>By Hans Hoffman</h6>
      </div>

      <div id="content">
        <br/><br/>

        <div class="row">
          <div class="col s12">
            <ul class="tabs">
              <li class="tab col s3"><a class="active" href="#tab1">List vs. Sales Price</a></li>
              <li class="tab col s3"><a href="#tab2">DOMP vs. DOMM</a></li>
            </ul>
          </div>

          <!-- ============================================= -->
          <!-- D3 List vs. Sales Price Code                  -->
          <!-- ============================================= -->
          <div id="tab1" class="col s12">
            <script>
              var margin = { top: 40, right: 20, bottom: 30, left: 300 },
                width = 1150 - margin.left - margin.right,
                height = 500 - margin.top - margin.bottom;

              var xAxis = d3.scaleBand()
                .range([0, width])
                .padding(0.1);

              var yAxis = d3.scaleLinear()
                .range([height, 0]);

              var svg = d3.select("body")
                .append("svg")
                  .attr("width", width + margin.left + margin.right)
                  .attr("height", height + margin.top + margin.bottom)
                .append("g")
                  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

              var div = d3.select("body")
                .append("div")
                  .attr("class", "tooltip")
                  .style("opacity", 0);

              d3.json("data.json", function(error, data) {
                if (error) throw error;

                data.forEach(function(d) {
                  d.avgListPrice = +d.avgListPrice;
                });

                xAxis.domain(data.map(function(d) { return d.year; }));
                yAxis.domain([0, d3.max(data, function(d) { return d.avgListPrice; })]);

                svg.selectAll(".bar")
                    .data(data)
                  .enter().append("rect")
                    .attr("class", "bar")
                    .attr("x", function(d) { return xAxis(d.year); })
                    .attr("width", xAxis.bandwidth())
                    .attr("y", function(d) { return yAxis(d.avgListPrice); })
                    .attr("height", function(d) { return height - yAxis(d.avgListPrice); })
                  .on('mouseover', function(d) {
                    div.transition()
                      .duration(200)
                      .style("opacity", .9)
                    .text("$" + d3.format(",")(d.avgListPrice))
                      .style("left", (d3.event.pageX) + "px")
                      .style("top", (d3.event.pageY - 28) + "px")
                  })
                  .on("mouseout", function(d) {
                    div.transition()
                      .duration(500)
                      .style("opacity", 0)
                  });

                svg.append("g")
                    .call(d3.axisBottom(xAxis))
                    .attr("class", "axis axis--x")
                    .attr("transform", "translate(0," + height + ")");

                svg.append("g")
                    .call(d3.axisLeft(yAxis));
              });
            </script>
          </div>

          <!-- ============================================= -->
          <!-- D3 DOMP vs. DOMM Code                         -->
          <!-- ============================================= -->
          <div id="tab2" class="col s12">
            <!-- // <script>
            //   var margin = {top: 40, right: 20, bottom: 30, left: 300},
            //     width = 1150 - margin.left - margin.right,
            //     height = 500 - margin.top - margin.bottom;
            //
            //   var xAxis = d3.scaleBand()
            //     .range([0, width])
            //     .padding(0.1);
            //
            //   var yAxis = d3.scaleLinear()
            //     .range([height, 0]);
            //
            //   var dompLine = d3.line()
            //     .x(function(d) { return xAxis(d.year); })
            //     .y(function(d) { return yAxis(d.avgDOMP); });
            //
            //   var dommLine = d3.line()
            //     .x(function(d) { return xAxis(d.year); })
            //     .y(function(d) { return yAxis(d.avgDOMM); });
            //
            //   var svg = d3.select("body")
            //     .append("svg")
            //       .attr("width", width + margin.left + margin.right)
            //       .attr("height", height + margin.top + margin.bottom)
            //     .append("g")
            //       .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
            //
            //   d3.json("data.json", function(error, data) {
            //     if (error) throw error;
            //
            //     xAxis.domain(data.map(function(d) { return d.year; }));
            //     yAxis.domain([0, d3.max(data, function(d) { return Math.max(d.avgDOMP, d.avgDOMM); })]);
            //
            //     svg.append("path")
            //       .data([data])
            //       .attr("class", "line")
            //       .attr("d", dompLine);
            //
            //     svg.append("path")
            //       .data([data])
            //       .attr("class", "line")
            //       .style("stroke", "skyblue")
            //       .attr("d", dommLine);
            //
            //     svg.append("g")
            //         .call(d3.axisBottom(xAxis))
            //         .attr("class", "axis axis--x")
            //         .attr("transform", "translate(0," + height + ")");
            //
            //     svg.append("g")
            //         .call(d3.axisLeft(yAxis));
            //
            //   });
            // </script> -->
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
